<html>
<head>
	<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>	
	<script type="text/javascript" src="../webgl_common/lib3rd/webgl-utils.js"></script>
	<script type="text/javascript" src="../webgl_common/lib3rd/gl-matrix.js"></script>
	<script type="text/javascript" src="../webgl_common/cglib/webgl-common.js"></script>
	<script type="text/javascript" src="../webgl_common/cglib/webgl-simple-mesh.js"></script>
	<script type="text/javascript" src="../webgl_common/cglib/webgl-container.js"></script>			
</head>
<body>
	<h1>WebGL Exercise 03</h1>
	<canvas 
		id="mycanvas"
		width="512"
		height="512">
	</canvas>
	<canvas 
		id="auxCanvas"
		width="512"
		height="512"
		style="display:none">
	</canvas>

	<script type="text/javascript">
  		canvas = jQuery("#mycanvas")[0];
  		var container = cglib.container.extend();
  		container.init(canvas);
  		container.loadApp('ex03', 'ex03.js', './');		

		textureCanvas = jQuery("#auxCanvas")[0];
		var ctx = textureCanvas.getContext('2d');		
		
		var auxTex = undefined;
		function drawToTexture(drawFunc) {			
			ctx.clearRect(0, 0, textureCanvas.width, textureCanvas.height);
			
			if(drawFunc)
				drawFunc(ctx);

			gl = container.getContext();

			if(!auxTex)
				auxTex = gl.createTexture();						

			gl.bindTexture(gl.TEXTURE_2D, auxTex);
			gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
			gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
			gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
			gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
			gl.bindTexture(gl.TEXTURE_2D, null);
		}				

	</script>

</body>
</html>

